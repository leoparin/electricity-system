<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.leo.electricitysystem.mapper.UniformErrorMapper">
    <insert id="insertUniformError">
        INSERT INTO uniform_error(ticket_id,helmet,gloves,uniform,create_time,update_time,img,result)
        values (#{ticketId},#{helmet},#{gloves},#{uniform},Current_Time(),current_time(),#{img},#{result})
    </insert>

    <select id="selectUniformErrorAndNameByUserId" resultType="map">
        -- 查看worker ID = 3的工人的姓名和着装错误
        SELECT ue.description,
               u.user_name
        from
            uniform_error ue
                LEFT JOIN sys_user u on ue.worker_id = u.id
        WHERE worker_id = #{userId};
    </select>

    <select id="getUniformErrorByWorkerId" resultType="com.leo.electricitysystem.domain.UniformError">
        select *
        from uniform_error ue
                 left join operation_ticket ot on ue.ticket_id = ot.id
                 left join sys_user u on ot.worker_id = #{id}
        where u.id = #{id};
    </select>


    
</mapper>